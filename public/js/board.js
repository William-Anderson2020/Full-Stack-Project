!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e){let s=[],a=[],i=!1;!function(t,e){for(let s=t;s>0;s--){document.getElementById("container").insertAdjacentHTML("afterbegin",`<div id="row${s}" class="row"></div>`);for(let t=e;t>0;t--)document.getElementById(`row${s}`).insertAdjacentHTML("beforeend",`<div class="tile" x="${s}" y="${t}"></div>`)}}(10,10);let o;function c(t){s.forEach(e=>{e.x==t.pos.x&&e.y==t.pos.y&&(e.occupied={isOccupied:!0,unit:t},t.pos.tile=e,e.dom.innerHTML=`<img class="board_sprite" src=${t.img}>`,a.push(e),s.forEach(t=>{t.occupied.unit==e.occupied.unit&&t.occupied.unit!={}&&t!=e&&(a=a.filter((function(e){return e!=t})),t.occupied.isOccupied=!1,t.occupied.unit={},t.dom.classList.remove("active"),(t.x<e.x||t.x==e.x&&t.dom.classList.contains("flip"))&&e.dom.classList.add("flip"),t.dom.innerHTML="",t.dom.classList.remove("flip"))}))})}function n(t,e){let a=[];return s.forEach(s=>{Math.abs(s.x-t.x)+Math.abs(s.y-t.y)<=e&&a.push(s)}),a}function r(t){let e=Object.assign({},t.stats),s=[];return t.item.stats!={}&&s.push(t.item.stats),t.pos.tile.terrain.stats!={}&&s.push(t.pos.tile.terrain.stats),s.forEach(t=>{Object.keys(t).forEach(s=>{e[s]+=t[s]})}),e}function l(t){let e;switch(t.weapon){case"sword":case"magic":e="t1";break;case"spear":e="t2";break;case"axe":e="t3";break;case"bow":wepaon="t3";break;default:e="t2"}return e}function d(t,e){!function(t,e){let s=n(e.pos.tile,t.stats.rng),a=s[0];Math.abs(t.pos.x-e.pos.x)+Math.abs(t.pos.y-e.pos.y)>1&&(s.forEach(e=>{e.dom.classList.contains("viable")&&Math.abs(e.x-t.pos.x)+Math.abs(e.y-t.pos.y)<Math.abs(a.x+a.y-(t.pos.x+t.pos.y))&&(a=e)}),t.pos.x=a.x,t.pos.y=a.y,e.pos.x>t.pos.x&&!t.pos.tile.dom.classList.contains("flip")&&t.pos.tile.dom.classList.add("flip"),c(t)),t.pos.tile.dom.innerHTML=`<img class="board_sprite anim_sprite" src="${t.anim}">`,t.pos.x<e.pos.x?t.pos.tile.dom.classList.contains("flip")||t.pos.tile.dom.classList.add("flip"):t.pos.tile.dom.classList.contains("flip")&&t.pos.tile.dom.classList.remove("flip"),setTimeout(e=>{c(t)},1600)}(t,e),function(t,e){args=[...arguments],args.forEach(t=>{t.cStats=r(t)});let s=1,a=1,i=0;i="magic"==t.weapon?e.cStats.res:e.cStats.def;let o=l(t),c=l(e);switch(o){case"t1":switch(c){case"t1":break;case"t2":s-=.2;break;case"t3":s+=.2}break;case"t2":switch(c){case"t1":s+=.2;break;case"t2":break;case"t3":s-=.2}break;case"t3":switch(c){case"t1":s-=.2;break;case"t2":s+=.2}break;default:console.log("weapon trianlge defaulting.")}Math.trunc(100*Math.random())<(t.cStats.lck+t.cStats.dex-e.cStats.lck)/2&&(a=1.5),dmg=(t.cStats.atk+Math.trunc(t.cStats.atk*s)-i)*a,dmg<0&&(dmg=0),console.log(damage),e.hp-=dmg,console.log(t.hp,e.hp),a>1&&console.log("Critical!")}(t,e)}function p(t){let e=function(t){let e;return s.forEach(s=>{s.x==t.getAttribute("x")&&s.y==t.getAttribute("y")&&(e=s)}),e}(t.target);if(1==e.occupied.isOccupied&&(e.dom.classList.contains("atkViable")&&e.occupied.unit.owner!=o.owner?d(o,e.occupied.unit):o=e.occupied.unit,s.forEach(t=>{t.dom.classList.remove("viable","atkViable")})),!a.includes(e)||1==i)return e.dom.classList.contains("viable")&&function t(e){let a=e;o.pos.x=a.x,o.pos.y=a.y,i=!1,c(o),s.forEach(e=>{e.dom.classList.remove("viable","atkViable"),e.dom.removeEventListener("click",t)})}(e),void s.forEach(t=>{t.dom.classList.remove("viable","atkViable"),i=!1});n(e,o.stats.mvt).forEach(t=>{0==t.occupied.isOccupied&&t.dom.classList.add("viable"),i=!0}),n(e,o.stats.mvt+o.stats.rng).forEach(t=>{t.dom.classList.contains("viable")&&(1!=t.occupied.isOccupied||t.occupied.unit.owner==o.owner)||t.occupied.unit.owner==o.owner||t.dom.classList.add("atkViable")})}document.querySelectorAll(".tile").forEach(t=>{let e={dom:t,x:parseInt(t.getAttribute("x")),y:parseInt(t.getAttribute("y")),occupied:{isOccupied:!1,unit:{}},terrain:{stats:{}}};s.push(e)}),c({img:"./img/ameliaIdle.png",anim:"./img/ameliaAtk.gif",name:"Amelia",hp:20,weapon:"spear",stats:{atk:3,def:2,mvt:2,rng:1,lck:2,dex:3},pos:{x:4,y:5,tile:{}},item:{name:"Training Sword",stats:{atk:1,hp:3}},owner:"Player 1"}),c({img:"./img/erikaIdle.png",anim:"./img/erikaAtk.gif",name:"Erika",hp:25,weapon:"sword",stats:{atk:2,def:1,mvt:3,rng:1,dex:20,lck:30},pos:{x:6,y:5,tile:{}},item:{name:"Wooden Shield",stats:{atk:1,def:2}},owner:"Player 2"}),s.forEach(t=>{t.dom.addEventListener("click",p)}),a.forEach(t=>{let e=t.occupied.unit;e.item.stats.hp&&(e.hp+=e.item.stats.hp)})}]);