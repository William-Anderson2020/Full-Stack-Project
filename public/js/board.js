!function(t){var e={};function a(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e){let a=[],s=[],i=!1;!function(t,e){for(let a=t;a>0;a--){document.getElementById("container").insertAdjacentHTML("afterbegin",`<div id="row${a}" class="row"></div>`);for(let t=e;t>0;t--)document.getElementById(`row${a}`).insertAdjacentHTML("beforeend",`<div class="tile" x="${a}" y="${t}"></div>`)}}(10,10);let o;function c(t){a.forEach(e=>{e.x==t.pos.x&&e.y==t.pos.y&&(e.occupied={isOccupied:!0,unit:t},t.pos.tile=e,e.dom.innerHTML=`<img class="board_sprite" src=${t.img}>`,s.push(e),a.forEach(t=>{t.occupied.unit==e.occupied.unit&&t.occupied.unit!={}&&t!=e&&(s=s.filter((function(e){return e!=t})),t.occupied.isOccupied=!1,t.occupied.unit={},t.dom.classList.remove("active"),(t.x<e.x||t.x==e.x&&t.dom.classList.contains("flip"))&&e.dom.classList.add("flip"),t.dom.innerHTML="",t.dom.classList.remove("flip"))}))})}function n(t,e){let s=[];return a.forEach(a=>{Math.abs(a.x-t.x)+Math.abs(a.y-t.y)<=e&&s.push(a)}),s}function r(t){let e=Object.assign({},t.stats),a=[];return t.item.stats!={}&&a.push(t.item.stats),t.pos.tile.terrain.stats!={}&&a.push(t.pos.tile.terrain.stats),a.forEach(t=>{Object.keys(t).forEach(a=>{e[a]+=t[a]})}),e}function l(t){let e;switch(t.weapon){case"sword":case"magic":e="t1";break;case"spear":e="t2";break;case"axe":e="t3";break;case"bow":wepaon="t3";break;default:e="t2"}return e}function d(t,e){!function(t,e){let a=n(e.pos.tile,t.stats.rng),s=a[0];Math.abs(t.pos.x-e.pos.x)+Math.abs(t.pos.y-e.pos.y)>1&&(a.forEach(e=>{e.dom.classList.contains("viable")&&Math.abs(e.x-t.pos.x)+Math.abs(e.y-t.pos.y)<Math.abs(s.x+s.y-(t.pos.x+t.pos.y))&&(s=e)}),t.pos.x=s.x,t.pos.y=s.y,e.pos.x>t.pos.x&&!t.pos.tile.dom.classList.contains("flip")&&t.pos.tile.dom.classList.add("flip"),c(t)),t.pos.tile.dom.innerHTML=`<img class="board_sprite anim_sprite" src="${t.anim}">`,t.pos.x<e.pos.x?t.pos.tile.dom.classList.contains("flip")||t.pos.tile.dom.classList.add("flip"):t.pos.tile.dom.classList.contains("flip")&&t.pos.tile.dom.classList.remove("flip"),setTimeout(e=>{c(t)},1600)}(t,e),function(t,e){args=[...arguments],args.forEach(t=>{t.cStats=r(t)});let a=1,s=1,i=0;i="magic"==t.weapon?e.cStats.res:e.cStats.def;let o=l(t),c=l(e);switch(o){case"t1":switch(c){case"t1":break;case"t2":a-=.2;break;case"t3":a+=.2}break;case"t2":switch(c){case"t1":a+=.2;break;case"t2":break;case"t3":a-=.2}break;case"t3":switch(c){case"t1":a-=.2;break;case"t2":a+=.2}break;default:console.log("weapon trianlge defaulting.")}Math.trunc(100*Math.random())<(t.cStats.luck+t.cStats.luck-e.cStats.luck)/2&&(s=1.5),damage=(t.cStats.atk+Math.trunc(t.cStats.atk*a)-i)*s,console.log(damage),e.hp-=damage,console.log(t.hp,e.hp)}(t,e)}function u(t){let e=function(t){let e;return a.forEach(a=>{a.x==t.getAttribute("x")&&a.y==t.getAttribute("y")&&(e=a)}),e}(t.target);if(1==e.occupied.isOccupied&&(e.dom.classList.contains("atkViable")&&e.occupied.unit.owner!=o.owner?d(o,e.occupied.unit):o=e.occupied.unit,a.forEach(t=>{t.dom.classList.remove("viable","atkViable")})),!s.includes(e)||1==i)return e.dom.classList.contains("viable")&&function t(e){let s=e;o.pos.x=s.x,o.pos.y=s.y,i=!1,c(o),a.forEach(e=>{e.dom.classList.remove("viable","atkViable"),e.dom.removeEventListener("click",t)})}(e),void a.forEach(t=>{t.dom.classList.remove("viable","atkViable"),i=!1});n(e,o.stats.mvt).forEach(t=>{0==t.occupied.isOccupied&&t.dom.classList.add("viable"),i=!0}),n(e,o.stats.mvt+o.stats.rng).forEach(t=>{t.dom.classList.contains("viable")&&(1!=t.occupied.isOccupied||t.occupied.unit.owner==o.owner)||t.occupied.unit.owner==o.owner||t.dom.classList.add("atkViable")})}document.querySelectorAll(".tile").forEach(t=>{let e={dom:t,x:parseInt(t.getAttribute("x")),y:parseInt(t.getAttribute("y")),occupied:{isOccupied:!1,unit:{}},terrain:{stats:{}}};a.push(e)}),c({img:"./img/ameliaIdle.png",anim:"./img/ameliaAtk.gif",name:"Amelia",hp:20,weapon:"spear",stats:{atk:3,def:2,mvt:2,rng:1},pos:{x:4,y:5,tile:{}},item:{name:"Training Sword",stats:{atk:1,hp:3}},owner:"Player 1"}),c({img:"./img/erikaIdle.png",anim:"./img/erikaAtk.gif",name:"Erika",hp:25,weapon:"sword",stats:{atk:2,def:1,mvt:3,rng:1},pos:{x:6,y:5,tile:{}},item:{name:"Wooden Shield",stats:{atk:1,def:2}},owner:"Player 2"}),a.forEach(t=>{t.dom.addEventListener("click",u)}),s.forEach(t=>{let e=t.occupied.unit;e.item.stats.hp&&(e.hp+=e.item.stats.hp)})}]);